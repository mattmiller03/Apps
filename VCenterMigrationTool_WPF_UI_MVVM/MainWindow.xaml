<Window x:Class="VCenterMigrationTool_WPF_UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="vCenter Migration Tool v1.0" 
        Height="1059" Width="1400"
        WindowStartupLocation="CenterScreen"
        WindowState="Normal">
    <Window.DataContext>
        <ViewModels:ConnectionSettingsViewModel />
    </Window.DataContext>
    <Window.Resources>
        <!-- Modern Button Style -->
        <Style x:Key="ModernButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#FF007ACC"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="5" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#FF005A9E"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#FF004578"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Background" Value="#FFCCCCCC"/>
                                <Setter Property="Foreground" Value="#FF666666"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ConnectButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonStyle}">
            <Setter Property="Background" Value="#FF4CAF50"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FF45A049"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="BackupButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonStyle}">
            <Setter Property="Background" Value="#FF2196F3"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FF1976D2"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="MigrationButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonStyle}">
            <Setter Property="Background" Value="#FFFF9800"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FFF57C00"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="DangerButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonStyle}">
            <Setter Property="Background" Value="#FFF44336"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#FFD32F2F"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="HeaderTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Margin" Value="5,10,5,5"/>
            <Setter Property="Foreground" Value="#FF2C3E50"/>
        </Style>
        <Style x:Key="StatusTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        <Style x:Key="ModernTextBoxStyle" TargetType="TextBox">
            <Setter Property="Padding" Value="8"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="BorderBrush" Value="#FFDDDDDD"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="FontSize" Value="12"/>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="#FF007ACC"/>
                    <Setter Property="BorderThickness" Value="2"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="ModernPasswordBoxStyle" TargetType="PasswordBox">
            <Setter Property="Padding" Value="8"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="BorderBrush" Value="#FFDDDDDD"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="FontSize" Value="12"/>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="#FF007ACC"/>
                    <Setter Property="BorderThickness" Value="2"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid Background="#FFF8F9FA">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <!-- Menu Bar -->
        <Menu Grid.Row="0" Background="#FF2C3E50" Foreground="White" Height="32" >
            <Menu.Resources>
                <Style TargetType="MenuItem">
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="FontSize" Value="12"/>
                    <Setter Property="Padding" Value="8,6"/>
                    <Style.Triggers>
                        <Trigger Property="IsHighlighted" Value="True">
                            <Setter Property="Background" Value="#FF3498DB"/>
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
                <Style TargetType="Separator">
                    <Setter Property="Background" Value="#FF7F8C8D"/>
                    <Setter Property="Height" Value="1"/>
                    <Setter Property="Margin" Value="5,2"/>
                </Style>
            </Menu.Resources>
            <MenuItem Header="File" Foreground="White" FontSize="12">
                <MenuItem Header="🔌 Connect to vCenter" Background="#FF34495E" Foreground="White"/>
                <MenuItem Header="🔌 Disconnect All" Background="#FF34495E" Foreground="White"/>
                <Separator/>
                <MenuItem Header="📥 Import Configuration" Command="{Binding ImportConfigurationCommand}" Background="#FF34495E" Foreground="White"/>
                <MenuItem Header="📤 Export Configuration" Command="{Binding ExportConfigurationCommand}" Background="#FF34495E" Foreground="White"/>
                <Separator/>
                <MenuItem Header="❌ Exit" Background="#FF34495E" Foreground="White"/>
            </MenuItem>
            <MenuItem Header="Tools" Foreground="White" FontSize="12">
                <MenuItem Header="⚙️ PowerCLI Configuration" Background="#FF34495E" Foreground="White"/>
                <MenuItem Header="🔍 Test Connectivity" Background="#FF34495E" Foreground="White"/>
                <MenuItem Header="✅ Validate Prerequisites" Background="#FF34495E" Foreground="White"/>
                <Separator/>
                <MenuItem Header="💾 Connection Settings" Command="{Binding OpenConnectionSettingsCommand}" Background="#FF34495E" Foreground="White"/>
                <MenuItem Header="📂 Load Connection Profile" Command="{Binding LoadProfileCommand}" IsEnabled="{Binding !IsLoadingProfile}" Background="#FF34495E" Foreground="White"/>
                <MenuItem Header="💾 Save Current Settings" Background="#FF34495E" Foreground="White"/>
            </MenuItem>
            <MenuItem Header="Help" Foreground="White" FontSize="12">
                <MenuItem Header="📖 Documentation" Background="#FF34495E" Foreground="White"/>
                <MenuItem Header="ℹ️ About" Background="#FF34495E" Foreground="White"/>
            </MenuItem>
        </Menu>
        <!-- Main Content Tabs -->
        <TabControl Grid.Row="1" Margin="10" Background="White">
            <!-- Connection Tab -->
            <TabItem Header="🔌 Connection" FontSize="14">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Grid Margin="20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <!-- Source vCenter -->
                        <Border Grid.Column="0" Margin="10"
                                Background="White" BorderBrush="#FFDDDDDD" BorderThickness="1" CornerRadius="5">
                            <StackPanel Margin="20">
                                <TextBlock Text="📍 Source vCenter 7.x" Style="{StaticResource HeaderTextStyle}" Margin="0,0,0,10"/>
                                <TextBlock Text="vCenter Server:" Style="{StaticResource HeaderTextStyle}"/>
                                <TextBox Style="{StaticResource ModernTextBoxStyle}"
                                         Text="{Binding CurrentSettings.SourceServer, Mode=TwoWay}" />
                                <TextBlock Text="Username:" Style="{StaticResource HeaderTextStyle}"/>
                                <TextBox Style="{StaticResource ModernTextBoxStyle}"
                                         Text="{Binding CurrentSettings.SourceUsername, Mode=TwoWay}" />
                                <TextBlock Text="Password:" Style="{StaticResource HeaderTextStyle}"/>
                                <PasswordBox Style="{StaticResource ModernPasswordBoxStyle}" PasswordChanged="SourcePasswordBox_PasswordChanged"/>
                                <Button Style="{StaticResource ConnectButtonStyle}"
                                        Content="🔗 Connect"
                                        Command="{Binding ConnectSourceCommand}" 
                                        Margin="5,20,5,5" Height="40"/>
                            </StackPanel>
                        </Border>
                        <!-- Destination vCenter -->
                        <Border Grid.Column="1" Margin="10"
                                Background="White" BorderBrush="#FFDDDDDD" BorderThickness="1" CornerRadius="5">
                            <StackPanel Margin="20">
                                <TextBlock Text="🎯 Destination vCenter 8.x" Style="{StaticResource HeaderTextStyle}" Margin="0,0,0,10"/>
                                <TextBlock Text="vCenter Server:" Style="{StaticResource HeaderTextStyle}"/>
                                <TextBox Style="{StaticResource ModernTextBoxStyle}"
                                         Text="{Binding CurrentSettings.DestinationServer, Mode=TwoWay}" />
                                <TextBlock Text="Username:" Style="{StaticResource HeaderTextStyle}"/>
                                <TextBox Style="{StaticResource ModernTextBoxStyle}"
                                         Text="{Binding CurrentSettings.DestinationUsername, Mode=TwoWay}" />
                                <TextBlock Text="Password:" Style="{StaticResource HeaderTextStyle}"/>
                                <PasswordBox Style="{StaticResource ModernPasswordBoxStyle}" PasswordChanged="DestPasswordBox_PasswordChanged"/>
                                <Button Style="{StaticResource ConnectButtonStyle}"
                                        Content="🔗 Connect"
                                        Command="{Binding ConnectDestCommand}"
                                        Margin="5,20,5,5" Height="40"/>
                            </StackPanel>
                        </Border>
                        <!-- Connection Status -->
                        <Border Grid.Row="1" Grid.ColumnSpan="2" Margin="10"
                                Background="White" BorderBrush="#FFDDDDDD" BorderThickness="1" CornerRadius="5">
                            <Grid Margin="20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                                    <Ellipse Width="12" Height="12" Margin="0,0,5,0"
                                             Fill="{Binding SourceStatusColor}"/>
                                    <TextBlock Text="Source Connection:" FontWeight="Bold" Margin="0,0,0,5" FontSize="14"/>
                                    <TextBlock Text="{Binding SourceStatus}" Style="{StaticResource StatusTextStyle}"/>
                                    <TextBlock Text="{Binding SourceVersion}" Style="{StaticResource StatusTextStyle}" Foreground="Gray" Margin="10,0,0,0"/>
                                </StackPanel>
                                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                                    <Ellipse Width="12" Height="12" Margin="0,0,5,0"
                                             Fill="{Binding DestStatusColor}"/>
                                    <TextBlock Text="Destination Connection:" FontWeight="Bold" Margin="0,0,0,5" FontSize="14"/>
                                    <TextBlock Text="{Binding DestStatus}" Style="{StaticResource StatusTextStyle}"/>
                                    <TextBlock Text="{Binding DestVersion}" Style="{StaticResource StatusTextStyle}" Foreground="Gray" Margin="10,0,0,0"/>
                                </StackPanel>
                                <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
                                    <Button Style="{StaticResource ModernButtonStyle}"
                                            Content="🔍 Test"
                                            Command="{Binding TestConnectionCommand}" Margin="0,0,5,0"/>
                                    <Button Style="{StaticResource DangerButtonStyle}"
                                            Content="🔌 Disconnect"
                                            Command="{Binding DisconnectAllCommand}"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </Grid>
                </ScrollViewer>
            </TabItem>
            <!-- Migration Tab -->
            <TabItem Header="🚀 Migration Tasks" FontSize="14">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <TextBlock Margin="0,0,0,10" 
                               Text="{Binding MigrationStatus}" FontWeight="Bold" Foreground="#FF2C3E50" FontSize="12"/>
                    <DataGrid Margin="0,0,0,10" 
                              ItemsSource="{Binding MigrationTasks}"
                              AutoGenerateColumns="False" CanUserAddRows="False" 
                              IsReadOnly="True" GridLinesVisibility="Horizontal"
                              Background="White" BorderBrush="#FFDDDDDD" BorderThickness="1" FontSize="11">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Object" Binding="{Binding ObjectName}" Width="150"/>
                            <DataGridTextColumn Header="Type" Binding="{Binding ObjectType}" Width="80"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="100"/>
                            <DataGridTextColumn Header="Progress" Binding="{Binding Progress}" Width="80"/>
                            <DataGridTextColumn Header="Start Time" Binding="{Binding StartTime}" Width="120"/>
                            <DataGridTextColumn Header="Duration" Binding="{Binding Duration}" Width="80"/>
                            <DataGridTextColumn Header="Details" Binding="{Binding Details}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    <StackPanel Grid.Row="2" Margin="0,10">
                        <TextBlock Text="Overall Migration Progress:" FontWeight="Bold" Foreground="#FF2C3E50" FontSize="12"/>
                        <ProgressBar Height="25" Margin="0,5"
                                     Value="{Binding OverallProgress}" Maximum="100"
                                     Background="#FFEEEEEE" Foreground="#FFFF9800"/>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <TextBlock Text="{Binding OverallProgress, StringFormat={}{0}% Complete}" Margin="0,0,20,0" 
                                       Foreground="#FF666666" FontSize="11"/>
                            <TextBlock Text="Estimated time: --" Foreground="Gray" FontSize="11"/>
                        </StackPanel>
                    </StackPanel>
                    <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                        <Button Style="{StaticResource MigrationButtonStyle}" Content="🚀 Start" Command="{Binding StartMigrationCommand}"/>
                        <Button Style="{StaticResource ModernButtonStyle}" Content="⏸️ Pause" Command="{Binding PauseMigrationCommand}"/>
                        <Button Style="{StaticResource DangerButtonStyle}" Content="⏹️ Stop" Command="{Binding StopMigrationCommand}"/>
                        <Button Style="{StaticResource ModernButtonStyle}" Content="📊 Export Report" Command="{Binding ExportReportCommand}"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Validation Tab -->
            <TabItem Header="✅ Validation" FontSize="14">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <TextBlock Margin="0,0,0,10" 
                               Text="{Binding ValidationStatus}" FontWeight="Bold" Foreground="#FF2C3E50" FontSize="12"/>
                    <DataGrid Margin="0,0,0,10"
                              ItemsSource="{Binding ValidationResults}"
                              AutoGenerateColumns="False" CanUserAddRows="False" 
                              IsReadOnly="True" GridLinesVisibility="Horizontal"
                              Background="White" BorderBrush="#FFDDDDDD" BorderThickness="1" FontSize="11">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Test Name" Binding="{Binding TestName}" Width="200"/>
                            <DataGridTextColumn Header="Result" Binding="{Binding Result}" Width="100"/>
                            <DataGridTextColumn Header="Details" Binding="{Binding Details}" Width="*"/>
                            <DataGridTextColumn Header="Recommendation" Binding="{Binding Recommendation}" Width="200"/>
                        </DataGrid.Columns>
                    </DataGrid>
                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                        <Button Style="{StaticResource BackupButtonStyle}" Content="🔍 Run Validation Tests" Command="{Binding RunValidationCommand}" FontSize="14" Height="45"/>
                        <Button Style="{StaticResource DangerButtonStyle}" Content="❌ Clear Results" Command="{Binding ClearResultsCommand}" FontSize="14" Height="45"/>
                    </StackPanel>
                </Grid>
            </TabItem>
            <!-- Activity Log Tab -->
            <TabItem Header="📝 Activity Log" FontSize="14">
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,5">
                        <Button Style="{StaticResource ModernButtonStyle}" Content="🗑️ Clear Log" Command="{Binding ClearLogCommand}"/>
                        <Button Style="{StaticResource ModernButtonStyle}" Content="💾 Save Log" Command="{Binding SaveLogCommand}"/>
                    </StackPanel>
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <TextBox IsReadOnly="True"
                                 FontFamily="Consolas" FontSize="10"
                                 Background="#FF1E1E1E" Foreground="#FFCCCCCC"
                                 AcceptsReturn="True" TextWrapping="Wrap"
                                 BorderThickness="0"
                                 Text="{Binding LogText, Mode=OneWay}"/>
                    </ScrollViewer>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
